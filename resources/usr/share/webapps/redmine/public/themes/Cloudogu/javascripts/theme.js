var PurpleMine=PurpleMine||{};PurpleMine.HistoryTabs=function(){"use strict";function a(){if(d)return d;d=this,this.$tabsContainer=null,this.$tabs=null,this.$history=$("#history"),this.lang=document.documentElement.lang,void 0===e[this.lang]&&(this.lang="en"),this._=e[this.lang],this.$history.length>0&&(b(),c())}function b(){var a="",b='<li><a href="javascript:;" class="',c='history-tab" data-tab="';a+='<div class="tabs"><ul>',a+=b+"selected "+c+'all">'+d._.all+"</a></li>",a+=b+c+'notes">'+d._.notes+"</a></li>",a+=b+c+'details">'+d._.details+"</a></li>",a+="</ul></div>",d.$tabsContainer=$(a),$("#history > h3").after(d.$tabsContainer),d.$tabs=d.$tabsContainer.find(".history-tab"),d.$tabs.on("click",f)}function c(){d.$history.find(".has-notes:first").addClass("first-of-notes"),d.$history.find(".has-details:first").addClass("first-of-details")}var d,e={en:{all:"All",notes:"Notes",details:"Changes"},pl:{all:"Wszystko",notes:"Notatki",details:"Zmiany"},de:{all:"Alles",notes:"Kommentare",details:"Änderungen"},ja:{all:"すべて",notes:"注記",details:"変更"}},f=function(){var a=$(this),b=a.attr("data-tab");d.$tabs.removeClass("selected"),a.addClass("selected"),d.$history.removeClass("hide-details").removeClass("hide-notes"),"notes"===b?d.$history.addClass("hide-details"):"details"===b&&d.$history.addClass("hide-notes")};return a}();var PurpleMine=PurpleMine||{};PurpleMine.MenuCollapse=function(){"use strict";function a(){if(e)return e;e=this,this.lang=document.documentElement.lang,void 0===f[this.lang]&&(this.lang="en"),this._=f[this.lang],this.menus={top:{$el:$("#top-menu")}};for(var a in this.menus)this.menus.hasOwnProperty(a)&&this.menus[a].$el.length>0&&b(a)}function b(a){if("none"===e.menus[a].$el.css("maxHeight"))return!1;e.menus[a].collapsed=!0,window.localStorage&&(e.menus[a].collapsed=null===localStorage.getItem(c(a))),d(a),!1===e.isCollapsed(a)&&e.expandMenu(a)}function c(a){return"PurpleMine:"+a+"MenuExpanded"}function d(a){var b=a+"-menu-toggler",c=e._[a+"MenuToggler"],d='<a href="javascript:;" class="'+b+'" title="'+c+'"></a>';e.menus[a].$toggler=$(d),e.menus[a].$el.prepend(e.menus[a].$toggler),e.menus[a].$toggler.on("click",{menu:a},e.toggleMenu)}var e,f={en:{topMenuToggler:"Expand/collapse top menu"},pl:{topMenuToggler:"Zwiń/rozwiń górne menu"},de:{topMenuToggler:"Ein-/Ausklappen Hauptmenu"},ja:{topMenuToggler:"トップメニューの展開/折りたたみ"}};return a.prototype.toggleMenu=function(a){var b=a.data.menu||"";e.isCollapsed(b)?e.expandMenu(b):e.collapseMenu(b)},a.prototype.isCollapsed=function(a){return this.menus[a].collapsed},a.prototype.expandMenu=function(a){this.menus[a].$el.addClass("expanded"),this.menus[a].$toggler.addClass("expanded"),this.menus[a].collapsed=!1,window.localStorage&&localStorage.setItem(c(a),"x")},a.prototype.collapseMenu=function(a){this.menus[a].$el.removeClass("expanded"),this.menus[a].$toggler.removeClass("expanded"),this.menus[a].collapsed=!0,window.localStorage&&localStorage.removeItem(c(a))},a}();var PurpleMine=PurpleMine||{};PurpleMine.RevisionGraph=function(a,b,c){"use strict";var d=b,e=$.map(d,function(a){return a}),f=e.length-1,g=$("table.changesets tr.changeset");null!==revisionGraph?revisionGraph.clear():revisionGraph=new Raphael(a);var h=revisionGraph.set(),i=g.first().find("td").first().position().left-$(a).position().left,j=$(a).position().top,k=i+20*(c+1),l=g.last().position().top+g.last().height()-j;revisionGraph.setSize(k,l);var m=["#e74c3c","#584492","#019851","#ed820c","#4183c4"];if(c>=m.length){Raphael.getColor.reset();for(var n=0;n<=c;n++)m.push(Raphael.getColor(.9))}var o,p,q,r,s,t,u,v;$.each(e,function(a,b){b.hasOwnProperty("space")||(b.space=0),q=g.eq(f-b.rdmid).position().top-j+17,p=i+10+20*b.space,revisionGraph.circle(p,q,3.5).attr({fill:m[b.space],stroke:"none"}).toFront(),$.each(b.parent_scmids,function(a,c){o=d[c],o?(o.hasOwnProperty("space")||(o.space=0),s=g.eq(f-o.rdmid).position().top-j+17,r=i+10+20*o.space,t=o.space===b.space?revisionGraph.path(["M",p,q,"V",s]):revisionGraph.path(["M",p,q,"C",p,q,p,q+(s-q)/2,p+(r-p)/2,q+(s-q)/2,"C",p+(r-p)/2,q+(s-q)/2,r,s-(s-q)/2,r,s])):t=revisionGraph.path(["M",p,q,"V",l]),t.attr({stroke:m[b.space],"stroke-width":1.5}).toBack()}),v=revisionGraph.circle(p,q,10),v.attr({fill:"#000",opacity:0,cursor:"pointer",href:b.href}),null!==b.refs&&b.refs.length>0&&(u=document.createElementNS(revisionGraph.canvas.namespaceURI,"title"),u.appendChild(document.createTextNode(b.refs)),v.node.appendChild(u)),h.push(v)}),h.toFront()},$(function(){"use strict";window.drawRevisionGraph&&(window.drawRevisionGraph=PurpleMine.RevisionGraph,$(window).resize())});var PurpleMine=PurpleMine||{};PurpleMine.SidebarToggler=function(){"use strict";function a(){if(e)return e;e=this,this.sidebarVisible=!0,this.sidebarHiding=null,this.$toggler=null,this.$main=$("#main"),this.$sidebar=$("#sidebar"),this.lang=document.documentElement.lang,void 0===f[this.lang]&&(this.lang="en"),this._=f[this.lang],"relative"===this.$main.css("position")&&$(window).load(function(){$("#context-menu").appendTo("#wrapper3")}),b()}function b(){window.localStorage&&(e.sidebarVisible=null===localStorage.getItem("PurpleMine:sidebarHidden")),e.$sidebar.length>0&&!1===e.$main.hasClass("nosidebar")&&(d(),c(),!1===e.sidebarVisible&&e.hideSidebar(!0))}function c(){var a=document.getElementsByTagName("body")[0];window.onkeydown=function(b){a===b.target&&83===b.keyCode&&!1===b.ctrlKey&&!1===b.altKey&&!1===b.shiftKey&&e.toggleSidebar()}}function d(){var a='<a href="javascript:;" class="sidebar-toggler" title="'+e._.toggler+'"></a>';e.$toggler=$(a),e.$main.append(e.$toggler),e.$toggler.on("click",e.toggleSidebar)}var e,f={en:{toggler:"Toggle sidebar"},pl:{toggler:"Pokaż/ukryj panel boczny"},ja:{toggler:"サイドバーの切り替え"}};return a.prototype.toggleSidebar=function(){e.sidebarVisible?e.hideSidebar():e.showSidebar()},a.prototype.hideSidebar=function(a){!0===a?this.$sidebar.addClass("sidebar-hiding sidebar-hidden"):(this.$sidebar.addClass("sidebar-hiding"),this.sidebarHiding=setTimeout(function(){e.$sidebar.addClass("sidebar-hidden")},500)),this.$toggler.addClass("sidebar-hidden"),this.sidebarVisible=!1,window.localStorage&&localStorage.setItem("PurpleMine:sidebarHidden","x")},a.prototype.showSidebar=function(){clearTimeout(this.sidebarHiding),e.$sidebar.removeClass("sidebar-hidden"),setTimeout(function(){e.$sidebar.removeClass("sidebar-hiding")},50),this.$toggler.removeClass("sidebar-hidden"),this.sidebarVisible=!0,window.localStorage&&localStorage.removeItem("PurpleMine:sidebarHidden")},a}(),$(function(){"use strict";new PurpleMine.SidebarToggler,new PurpleMine.HistoryTabs,new PurpleMine.MenuCollapse});